services:
    backend.listener.access_denied_exception:
        class:     Backend\EventListener\AccessDeniedExceptionListener
        arguments: [ '@service_container' ]
        tags:
            - { name: kernel.event_listener, event: kernel.exception, method: onKernelException, priority: 100 }

    backend.security.user.provider:
        class:     Common\Core\Component\Security\User\UserProvider
        arguments: [ '@orm.manager', [ 'instance', 'manager' ] ]

    backend.security.user.oauth_provider:
        class:     Common\Core\Component\Security\User\OAuthUserProvider
        arguments: [ '@orm.manager', '@session', [ 'instance', 'manager' ] ]

    backend_login_success_handler:
        class:     Backend\EventListener\LoginSuccessHandler
        arguments: [ '@service_container' ]

    oauth_login_success_handler:
        class:     Backend\EventListener\OAuthLoginSuccessHandler
        arguments: [ '@security.token_storage', '@router', '@session' ]
