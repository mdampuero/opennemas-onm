services:
    context:
        class: Symfony\Component\Routing\RequestContext
        calls:
            - [ fromRequest, [ %request% ] ]

    matcher:
        class: Symfony\Component\Routing\Matcher\UrlMatcher
        arguments: [ %routes%, @context ]

    url_generator:
        class: Symfony\Component\Routing\Generator\UrlGenerator
        arguments: [ %routes%, @context ]

    db_conn:
        class: Onm\DatabaseConnection
        calls:
            - [ connect, [ %database_params%] ]

    session_storage:
        class: %session_storage_class%
        arguments: [ %session_params% ]

    session:
        class: %session_handler_class%
        arguments: [ @session_storage ]

    logger:
        class: Onm\Log
        arguments: [ 'normal' ]

    mailer:
        class: Onm\Mailer
        arguments: [ %swiftmailer% ]

    entity_repository:
        class: Onm\ORM\EntityRepository
        arguments: [ @cache ]

    users_repository:
        class: Repository\UsersManager
        arguments: [ @cache, @logger ]

    cache:
        class: %cache_handler%
        arguments: [ %cache_handler_params% ]

    automatic_contents:
        class: Onm\MachineSearcher
        arguments: [ @cache ]
