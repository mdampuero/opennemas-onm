#!/usr/bin/env php
<?php
use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\Routing\RouteCollection;

require __DIR__.'/../app/autoload.php';

// Load the available route collection
$routes = new \Symfony\Component\Routing\RouteCollection();

// Create the request object
$request = Request::createFromGlobals();
$request->setTrustedProxies(array('127.0.0.1'));

require __DIR__.'/../app/container.php';

use Symfony\Component\Console\Application;

$application = new Application();

// Iterate over all the available command classes and register them into the
// console application
$basePath = APPLICATION_PATH.'/app/';
$availableCommandClases = glob($basePath.'*/Command/*');
foreach ($availableCommandClases as $file) {
    $commandClass = str_replace(
        array($basePath, '.php', '/'),
        array('', '', '\\'),
        $file
    );

    if (class_exists($commandClass)) {
        $application->add(new $commandClass);
    }
}
$application->run();
